(()=>{"use strict";const e="https://6536d186bb226bb85dd2a7da.mockapi.io/users";var o,t;!function(e){let o=new Image;o.onload=o.onerror=function(){e(2==o.height)},o.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let o=!0===e?"webp":"no-webp";document.documentElement.classList.add(o)})),function(e){const o=document.title,t=e;document.addEventListener("DOMContentLoaded",(()=>{for(const e of t){if(e==o){document.querySelector("html").classList.remove("noFooter"),document.querySelector("html").classList.add("noFooter");break}document.querySelector("html").classList.remove("noFooter")}}))}(["Главная","Регистрация","Вход"]),function(){const e=document.title,o=(document.querySelector(".header"),document.querySelector(".header__btn-left")),t=document.querySelector(".header__title"),n=document.querySelector(".header__btn-right");console.log(window.location.href),console.log(e),document.addEventListener("DOMContentLoaded",(()=>{o.href=localStorage.getItem("previousPage"),t.textContent=e,"Главная"==e?(o.classList.add("hide"),n.classList.add("hide")):(o.classList.remove("hide"),n.classList.remove("hide"))})),window.addEventListener("unload",(()=>{localStorage.setItem("previousPages",previousPages.push(window.location.href))}))}(),o="login.html",t=e,document.addEventListener("DOMContentLoaded",(()=>{if(window.location.href.includes(o)){const e=document.querySelector(".login__nickname"),n=document.querySelector(".login__password"),r=document.querySelector(".login__button"),c=JSON.parse(localStorage.getItem("DnD-manager-by-Yafiarbe"));let s;async function a(e){try{const o=await fetch(e);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(e){console.error("Ошибка:",e)}}console.log("localStr down"),console.log(c.name),e.value=c.name,n.value=c.password,a(t).then((e=>{s=e,console.log("Данные успешно сохранены в переменной userDataBase"),console.log(s)})),r.onclick=o=>{o.preventDefault(),console.log("CLICKCLICK");for(const o in s)if(Object.hasOwnProperty.call(s,o)){const t=s[o];console.log(t),e.value==t.user?window.location.href="navigator.html":e.style.border="1px solid red"}}}})),function(e,o){if(window.location.href.includes(e)){console.log("Welcom to Registration!");const t=document.querySelector(".registration__nickname"),n=document.querySelector(".registration__password"),r=document.querySelector(".registration__button");let c,s=[];function a(){fetch(o).then((e=>e.json())).then((e=>{s=e,console.log(s)})).catch((e=>console.error("Ошибка:",e)))}function l(e,o){return console.log(e),console.log(o),e.some((function(e){return e.user===o}))}async function i(e){try{const o=await fetch(e);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(e){console.error("Ошибка:",e)}}console.log(t.value),console.log(n.value),document.addEventListener("DOMContentLoaded",(()=>{a();for(const e in s)if(Object.hasOwnProperty.call(s,e)){const o=s[e];console.log(o)}})),r.addEventListener("click",(e=>{if(e.preventDefault(),l(s,t.value))t.value="",t.placeholder="Имя занято!",t.style.border="1px solid red",a();else{const e={user:`${t.value}`,password:`${n.value}`,accessLevel:"player",characters:{}};fetch(o,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e.ok)return e.json()})).then((e=>{})).catch((e=>{})),localStorage.setItem("DnD-manager-by-Yafiarbe",JSON.stringify({name:`${t.value}`,pass:`${n.value}`})),window.location.href="login.html"}})),i(o).then((e=>{c=e,console.log("Данные успешно сохранены в переменной userDataBase"),console.log(c)}))}}("registration.html",e)})();