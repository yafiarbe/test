/*! For license information please see app.min.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={"./src/js/app.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _modules_functions_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./modules/functions.js */ \"./src/js/modules/functions.js\");\n/* harmony import */ var _layouts_header_header_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../layouts/header/header.js */ \"./src/layouts/header/header.js\");\n/* harmony import */ var _pages_login_login_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../pages/login/login.js */ \"./src/pages/login/login.js\");\n/* harmony import */ var _pages_registration_registration_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../pages/registration/registration.js */ \"./src/pages/registration/registration.js\");\n\r\n\r\n\r\nconst usersDB = 'https://6536d186bb226bb85dd2a7da.mockapi.io/users'\r\n\r\n//  Функция проверки браузера на поддержку webp\r\n;\r\n_modules_functions_js__WEBPACK_IMPORTED_MODULE_0__.isWebp();\r\n\r\n// Добавляет класс .noFooter для HTML\r\n// далее css регулирует высоту .main на указаных страницах\r\n_modules_functions_js__WEBPACK_IMPORTED_MODULE_0__.htmlAddClassNoFooter([\r\n    'Главная',\r\n    'Регистрация',\r\n    'Вход',\r\n]);\r\n\r\n\r\n(0,_layouts_header_header_js__WEBPACK_IMPORTED_MODULE_1__.header)()\r\n\r\n\r\n// Функционал страницы входа\r\n;\r\n(0,_pages_login_login_js__WEBPACK_IMPORTED_MODULE_2__.login)('login.html', usersDB)\r\n\r\n// Функционал страницы регистрации\r\n;\r\n(0,_pages_registration_registration_js__WEBPACK_IMPORTED_MODULE_3__.registration)('registration.html', usersDB)\n\n//# sourceURL=webpack://gulp-dnd-manager/./src/js/app.js?")},"./src/js/modules/functions.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   htmlAddClassNoFooter: () => (/* binding */ htmlAddClassNoFooter),\n/* harmony export */   isWebp: () => (/* binding */ isWebp)\n/* harmony export */ });\n/* Проверка поддержки webp, добавление класса webp или no-webp для HTML */\r\nfunction isWebp() {\r\n    // Проверка поддержки webp \r\n    function testWebP(callback) {\r\n        let webP = new Image();\r\n        webP.onload = webP.onerror = function () {\r\n            callback(webP.height == 2);\r\n        };\r\n        webP.src = \"data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA\";\r\n    }\r\n    // Добавление класса _webp или _no-webp для HTML\r\n    testWebP(function (support) {\r\n        let className = support === true ? 'webp' : 'no-webp';\r\n        document.documentElement.classList.add(className);\r\n    });\r\n}\r\n\r\nfunction htmlAddClassNoFooter(arr) {\r\n    const currentPage = document.title;\r\n    const cropMenu = arr;\r\n\r\n    document.addEventListener('DOMContentLoaded', () => {\r\n        for (const iterator of cropMenu) {\r\n            if (iterator == currentPage) {\r\n                document.querySelector('html').classList.remove('noFooter');\r\n                document.querySelector('html').classList.add('noFooter');\r\n                break\r\n            } else {\r\n                document.querySelector('html').classList.remove('noFooter');\r\n            }\r\n        }\r\n    })\r\n\r\n};\r\n\r\n\n\n//# sourceURL=webpack://gulp-dnd-manager/./src/js/modules/functions.js?")},"./src/layouts/header/header.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   header: () => (/* binding */ header)\n/* harmony export */ });\nfunction header() {\r\n    const currentPageTitle = document.title;\r\n    const header = document.querySelector('.header');\r\n    const leftButton = document.querySelector('.header__btn-left');\r\n    const title = document.querySelector('.header__title');\r\n    const rightButton = document.querySelector('.header__btn-right');\r\n    let previousPage;\r\n\r\n\r\n    console.log(window.location.href);\r\n    console.log(currentPageTitle);\r\n\r\n    document.addEventListener('DOMContentLoaded', () => {\r\n        leftButton.href = localStorage.getItem('previousPage')\r\n        title.textContent = currentPageTitle;\r\n        leftBtnControl();\r\n    });\r\n\r\n    function leftBtnControl(){\r\n        if(currentPageTitle == 'Главная'){\r\n            leftButton.classList.add(\"hide\")\r\n            rightButton.classList.add(\"hide\")\r\n        } else{\r\n            leftButton.classList.remove(\"hide\")\r\n            rightButton.classList.remove(\"hide\")\r\n        }\r\n    };\r\n\r\n    window.addEventListener('unload', () => {\r\n        localStorage.setItem('previousPages', previousPages.push(window.location.href));\r\n    });\r\n}\n\n//# sourceURL=webpack://gulp-dnd-manager/./src/layouts/header/header.js?")},"./src/pages/login/login.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   login: () => (/* binding */ login)\n/* harmony export */ });\nfunction login(loginPage, linkUsersDB) {\r\n    document.addEventListener('DOMContentLoaded', () => {\r\n        if (window.location.href.includes(loginPage)) {\r\n\r\n            const name = document.querySelector('.login__nickname');\r\n            const password = document.querySelector('.login__password');\r\n            const button = document.querySelector('.login__button');\r\n            const localStr = JSON.parse(localStorage.getItem(\"DnD-manager-by-Yafiarbe\"));\r\n            let usersDataBase;\r\n\r\n            console.log('localStr down');\r\n            console.log(localStr.name);\r\n\r\n            name.value = localStr.name;\r\n            password.value = localStr.password;\r\n\r\n            // Получение списка пользователей\r\n            async function getData(apiUrl) {\r\n                try {\r\n                    const response = await fetch(apiUrl);\r\n                    if (!response.ok) {\r\n                        throw new Error(`HTTP error! status: ${response.status}`);\r\n                    }\r\n                    const data = await response.json();\r\n                    return data;\r\n                } catch (error) {\r\n                    console.error('Ошибка:', error);\r\n                }\r\n            }\r\n\r\n            getData(linkUsersDB).then(data => {\r\n                usersDataBase = data;\r\n                console.log('Данные успешно сохранены в переменной userDataBase');\r\n                console.log(usersDataBase);\r\n            });\r\n\r\n            // Действите во время клика по кнопке\r\n            button.onclick = (event) => {\r\n                event.preventDefault()\r\n                console.log('CLICKCLICK');\r\n\r\n                // поиск совпадений в базе\r\n                for (const key in usersDataBase) {\r\n                    if (Object.hasOwnProperty.call(usersDataBase, key)) {\r\n                        const element = usersDataBase[key];\r\n                        console.log(element);\r\n                        if (name.value == element.user) {\r\n                            window.location.href = \"navigator.html\";\r\n                            break\r\n                        } else {\r\n                            name.style.border = \"1px solid red\"\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        }\r\n    })\r\n};\r\n\r\n\n\n//# sourceURL=webpack://gulp-dnd-manager/./src/pages/login/login.js?")},"./src/pages/registration/registration.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registration: () => (/* binding */ registration)\n/* harmony export */ });\nfunction registration(regPage, arrayUsers) {\r\n\r\n    if (window.location.href.includes(regPage)) {\r\n\r\n        console.log('Welcom to Registration!');\r\n\r\n\r\n        const name = document.querySelector('.registration__nickname');\r\n        const password = document.querySelector('.registration__password');\r\n        const buttonSend = document.querySelector('.registration__button');\r\n        let baseActual = [];\r\n\r\n        console.log(name.value);\r\n        console.log(password.value);\r\n\r\n        document.addEventListener('DOMContentLoaded', () => {\r\n\r\n            loadUserDB()\r\n\r\n            for (const key in baseActual) {\r\n                if (Object.hasOwnProperty.call(baseActual, key)) {\r\n                    const element = baseActual[key];\r\n                    console.log(element);\r\n\r\n                }\r\n            }\r\n        })\r\n\r\n\r\n\r\n\r\n\r\n        buttonSend.addEventListener('click', (event) => {\r\n            event.preventDefault()\r\n\r\n            // Проверка, есть ли такой пользователь\r\n            if (checkUserExists(baseActual, name.value)) {\r\n                name.value = '';\r\n                name.placeholder = 'Имя занято!';\r\n                name.style.border = '1px solid red';\r\n                loadUserDB()\r\n            } else {\r\n                const newUser = {\r\n                    user: `${name.value}`,\r\n                    password: `${password.value}`,\r\n                    accessLevel: \"player\",\r\n                    characters: {},\r\n                }\r\n\r\n                fetch(arrayUsers, {\r\n                    method: 'POST',\r\n                    headers: { 'content-type': 'application/json' },\r\n                    // Отправьте данные в теле запроса в формате JSON\r\n                    body: JSON.stringify(newUser)\r\n                }).then(res => {\r\n                    if (res.ok) {\r\n                        return res.json();\r\n                    }\r\n                    // handle error\r\n                }).then(newUser => {\r\n                    // сделать что-либо с новой задачей\r\n                }).catch(error => {\r\n                    // handle error\r\n                })\r\n                localStorage.setItem('DnD-manager-by-Yafiarbe', JSON.stringify({ name: `${name.value}`, pass: `${password.value}` }))\r\n                window.location.href = \"login.html\";\r\n\r\n            }\r\n\r\n        });\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        //functions\r\n        function loadUserDB() {\r\n            fetch(arrayUsers)\r\n                .then(response => response.json())\r\n                .then(json => {\r\n                    baseActual = json; // Записываем данные в переменную\r\n                    console.log(baseActual); // Проверяем данные\r\n                })\r\n                .catch(error => console.error('Ошибка:', error));\r\n        }\r\n\r\n        function checkUserExists(array, username) {\r\n            console.log(array);\r\n            console.log(username);\r\n            return array.some(function (item) {\r\n                return item.user === username;\r\n            });\r\n        }\r\n\r\n\r\n        async function getData(apiUrl) {\r\n            try {\r\n                const response = await fetch(apiUrl);\r\n                if (!response.ok) {\r\n                    throw new Error(`HTTP error! status: ${response.status}`);\r\n                }\r\n                const data = await response.json();\r\n                return data;\r\n            } catch (error) {\r\n                console.error('Ошибка:', error);\r\n            }\r\n        }\r\n\r\n        let userDataBase;\r\n        getData(arrayUsers).then(data => {\r\n            userDataBase = data;\r\n            console.log('Данные успешно сохранены в переменной userDataBase');\r\n            console.log(userDataBase);\r\n        });\r\n\r\n\r\n        // проверки\r\n        function checkNameValue() {\r\n            return name.value == \"\";\r\n        };\r\n\r\n        function checkPasswordValue() {\r\n            return password.value == \"\";\r\n        };\r\n\r\n\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\n/* const newUser = {\r\n    user: `${name.value}`,\r\n    password: `${password.value}`,\r\n    accessLevel: \"player\",\r\n    characters: {},\r\n}\r\n\r\nfetch(baseUsers, {\r\n    method: 'POST',\r\n    headers: { 'content-type': 'application/json' },\r\n    // Send your data in the request body as JSON\r\n    body: JSON.stringify(newUser)\r\n}).then(res => {\r\n    if (res.ok) {\r\n        return res.json();\r\n    }\r\n    // handle error\r\n}).then(task => {\r\n    // do something with the new task\r\n}).catch(error => {\r\n    // handle error\r\n}) */\r\n\r\n\r\n/* fetch(baseUsers, {\r\n    method: 'GET',\r\n    headers: { 'content-type': 'application/json' },\r\n}).then(res => {\r\n    if (res.ok) {\r\n        baseActual = res.json();\r\n    }\r\n    // handle error\r\n}).then(tasks => {\r\n    // Do something with the list of tasks\r\n}).catch(error => {\r\n    // handle error\r\n}); */\n\n//# sourceURL=webpack://gulp-dnd-manager/./src/pages/registration/registration.js?")}},__webpack_module_cache__={};function __webpack_require__(r){var e=__webpack_module_cache__[r];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(r,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),__webpack_require__.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/js/app.js")})();